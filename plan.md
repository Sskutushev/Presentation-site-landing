# Промпт для улучшения проекта DexSafe Wallet Pro

## Контекст проекта

Ты работаешь с проектом **DexSafe Wallet Pro** — React-лендингом на Vite + TypeScript + Tailwind CSS + Framer Motion. Структура проекта описана в README.md. Текущая сборка полностью функциональна, твоя задача — улучшить качество кода, надежность и презентабельность БЕЗ нарушения существующей логики.

## Критические требования

- **НЕ ТРОГАЙ** существующую логику компонентов и их взаимодействие
- **НЕ МЕНЯЙ** структуру папок и файлов без необходимости
- **ДОБАВЛЯЙ** новые файлы/папки для новой функциональности
- **ПРОВЕРЯЙ** совместимость всех зависимостей перед установкой
- **СОХРАНЯЙ** текущие цветовые схемы и дизайн
- Все команды выполняются через CLI в VS Code

---

## ЭТАП 1: Настройка тестирования

### 1.1 Установка зависимостей для тестирования

```bash
npm install -D vitest @testing-library/react @testing-library/jest-dom @testing-library/user-event jsdom
npm install -D @vitest/ui
npm install -D cypress
```

### 1.2 Создание конфигурации Vitest

Создай файл `vitest.config.ts` в корне:

- Импортируй настройки из `vite.config.ts`
- Добавь `test` конфигурацию с `globals: true`, `environment: 'jsdom'`
- Укажи `setupFiles: './src/tests/setup.ts'`

### 1.3 Создание структуры тестов

Создай папку `src/tests/`:

- `setup.ts` — глобальная настройка (импорт @testing-library/jest-dom)
- `unit/` — юнит-тесты для компонентов
- `integration/` — интеграционные тесты

### 1.4 Написание базовых тестов

Создай файлы тестов:

- `src/tests/unit/Button.test.tsx` — проверка рендера Button с разными пропсами
- `src/tests/unit/Card.test.tsx` — проверка рендера Card
- `src/tests/integration/Navigation.test.tsx` — проверка работы навигации из Header

### 1.5 Настройка Cypress для E2E

```bash
npx cypress open
```

Создай `cypress/e2e/landing.cy.ts`:

- Тест на проверку загрузки всех секций
- Тест на работу навигационных ссылок
- Тест на корректное отображение на мобильных разрешениях

### 1.6 Добавление скриптов в package.json

```json
"test": "vitest",
"test:ui": "vitest --ui",
"test:coverage": "vitest --coverage",
"cypress:open": "cypress open",
"cypress:run": "cypress run"
```

---

## ЭТАП 2: Линтинг и форматирование

### 2.1 Установка Prettier

```bash
npm install -D prettier eslint-config-prettier eslint-plugin-prettier
```

### 2.2 Создание .prettierrc

Создай файл `.prettierrc` в корне:

```json
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 100
}
```

### 2.3 Создание .prettierignore

```
dist
node_modules
coverage
.next
*.md
```

### 2.4 Обновление ESLint конфигурации

В файле `.eslintrc.cjs` (или создай если нет):

- Добавь `extends: ['prettier']`
- Добавь правила для React Hooks
- Добавь правила для TypeScript (no-unused-vars, explicit-function-return-type)

### 2.5 Добавление скриптов

```json
"lint": "eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0",
"lint:fix": "eslint . --ext ts,tsx --fix",
"format": "prettier --write \"src/**/*.{ts,tsx,css}\"",
"format:check": "prettier --check \"src/**/*.{ts,tsx,css}\""
```

### 2.6 Форматирование существующего кода

```bash
npm run format
npm run lint:fix
```

---

## ЭТАП 3: CI/CD с GitHub Actions

### 3.1 Создание структуры workflows

Создай папку `.github/workflows/`

### 3.2 Создание ci.yml

Файл `.github/workflows/ci.yml`:

- Триггеры: push в main, pull_request
- Jobs:
  - Setup (установка Node.js, кеширование зависимостей)
  - Lint (запуск lint)
  - Test (запуск vitest)
  - Build (npm run build)
  - E2E (запуск Cypress)

### 3.3 Создание deploy.yml

Файл `.github/workflows/deploy.yml`:

- Триггер: push в main после успешного CI
- Шаги:
  - Сборка проекта
  - Деплой на Vercel/Netlify через CLI или GitHub Integration

### 3.4 Настройка переменных окружения

В настройках GitHub репозитория добавь secrets для деплоя (токены Vercel/Netlify)

---

## ЭТАП 4: Интернационализация (i18n)

### 4.1 Установка зависимостей

```bash
npm install react-i18next i18next i18next-browser-languagedetector
```

### 4.2 Создание структуры локализации

Создай папку `src/locales/`:

- `en/` — английские переводы
- `ru/` — русские переводы
  Внутри каждой папки создай `translation.json`

### 4.3 Извлечение текстов из компонентов

Пройдись по всем секциям (1_HeroSection.tsx до 8_ContactSection.tsx):

- Вынеси ВСЕ текстовые строки в JSON файлы
- Структурируй по секциям: `{ "hero": { "title": "...", "subtitle": "..." } }`
- Сохрани текущие русские тексты в `ru/translation.json`
- Создай английские аналоги в `en/translation.json`

### 4.4 Настройка i18next

Создай файл `src/i18n.ts`:

- Инициализация i18next
- Подключение browserLanguageDetector
- Загрузка ресурсов (ru, en)
- Настройка fallback языка: 'ru'

### 4.5 Интеграция в приложение

В `main.tsx`:

- Импортируй `./i18n`
- Оберни App в `<I18nextProvider>`

### 4.6 Рефакторинг компонентов

В каждой секции:

- Импортируй `useTranslation` из react-i18next
- Замени текстовые строки на `t('section.key')`
- Пример: `t('hero.title')` вместо "DexSafe Wallet Pro"

### 4.7 Компонент переключения языка

В `0_Header.tsx`:

- Добавь кнопку/селектор для переключения языка
- Используй `i18n.changeLanguage('en' | 'ru')`
- Сохраняй выбранный язык в localStorage

### 4.8 Определение языка по геопозиции

Создай файл `src/lib/geoLanguage.ts`:

- Функция для определения страны через IP (используй публичные API: ipapi.co или ipgeolocation.io)
- Маппинг стран на языки: RU/BY/KZ/UA → 'ru', остальные → 'en'
- Функция должна вызываться один раз при загрузке и устанавливать язык через i18n.changeLanguage()

В `main.tsx`:

- Вызови функцию определения языка перед рендером App
- Добавь fallback на 'ru' при ошибке определения

---

## ЭТАП 5: Улучшение архитектуры кода

### 5.1 Создание утилит (DRY принцип)

Создай папку `src/lib/utils/`:

- `formatters.ts` — функции форматирования (даты, числа)
- `validators.ts` — валидация форм (если есть)
- `constants.ts` — константы (цвета, размеры, URL)

### 5.2 Рефакторинг повторяющегося кода

Проанализируй компоненты секций:

- Если есть похожие паттерны (например, заголовки секций) — вынеси в отдельный компонент `SectionHeader.tsx`
- Если есть повторяющиеся стили — создай переиспользуемые CSS классы или компоненты

### 5.3 Типизация пропсов

Проверь все компоненты:

- Убедись, что ВСЕ пропсы типизированы через interface или type
- Экспортируй типы для переиспользования
- Добавь JSDoc комментарии для сложных компонентов

### 5.4 Оптимизация производительности

- Добавь `React.memo` для тяжелых компонентов (PhoneMockup, секции с анимациями)
- Используй `useMemo` для дорогих вычислений
- Используй `useCallback` для функций, передаваемых в дочерние компоненты

### 5.5 Управление состоянием (опционально)

Если в будущем планируется расширение:

```bash
npm install zustand
```

Создай `src/store/`:

- `languageStore.ts` — хранилище языка
- `themeStore.ts` — хранилище темы (если планируется)

---

## ЭТАП 6: Документация и финализация

### 6.1 Обновление README.md

Добавь новые секции:

- "Тестирование" — как запускать тесты
- "CI/CD" — описание пайплайнов
- "Интернационализация" — как добавлять новые языки
- "Архитектура" — обновленная структура проекта

### 6.2 Создание CONTRIBUTING.md

Опиши правила для контрибьюторов:

- Code style (Prettier + ESLint)
- Как писать тесты
- Как создавать Pull Request

### 6.3 Создание CHANGELOG.md

Документируй все внесенные изменения:

- [Added] — новая функциональность
- [Changed] — изменения в существующем коде
- [Fixed] — исправленные баги

### 6.4 Добавление JSDoc комментариев

Для ключевых функций и компонентов:

```typescript
/**
 * Компонент кнопки с анимацией
 * @param variant - стиль кнопки ('primary' | 'secondary')
 * @param children - содержимое кнопки
 */
```

### 6.5 Финальная проверка

```bash
npm run lint
npm run format:check
npm run test
npm run build
```

### 6.6 Создание pre-commit хуков

```bash
npm install -D husky lint-staged
npx husky-init
```

В `.husky/pre-commit`:

```bash
npx lint-staged
```

В `package.json`:

```json
"lint-staged": {
  "*.{ts,tsx}": ["eslint --fix", "prettier --write"],
  "*.{css,md}": ["prettier --write"]
}
```

---

## ПОРЯДОК ВЫПОЛНЕНИЯ

1. **ЭТАП 1** → Тестирование (можно параллельно с остальным)
2. **ЭТАП 2** → Линтинг и форматирование (применить ко всему коду)
3. **ЭТАП 5** → Рефакторинг архитектуры (подготовка к i18n)
4. **ЭТАП 4** → Интернационализация (требует чистого кода)
5. **ЭТАП 3** → CI/CD (после того как все работает локально)
6. **ЭТАП 6** → Документация и финализация

---

## КРИТЕРИИ УСПЕХА

✅ Все тесты проходят (unit, integration, E2E)
✅ ESLint не показывает ошибок и предупреждений
✅ Prettier форматирует код единообразно
✅ CI/CD пайплайн успешно выполняется
✅ Сайт поддерживает 2 языка (ru, en)
✅ Автоопределение языка по геопозиции работает
✅ Проект собирается без ошибок (`npm run build`)
✅ Coverage тестов > 70%
✅ Документация обновлена

---

## ВАЖНО

- После каждого этапа проверяй работоспособность: `npm run dev`
- Делай коммиты после каждого логического блока работы
- Не удаляй существующие файлы без крайней необходимости
- Сохраняй обратную совместимость
- При любых сомнениях — спрашивай перед внесением изменений

Начни с **ЭТАПА 2** (линтинг и форматирование), чтобы сразу привести код к единому стандарту, затем переходи к тестированию.
